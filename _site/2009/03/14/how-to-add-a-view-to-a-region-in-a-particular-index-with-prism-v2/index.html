<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>How to: Add a View to a Region in a particular index with Prism-v2 &#8211; A sea of code</title>
<meta name="description" content="Pseudo-random thoughts related to software development...">
<meta name="keywords" content="C#, Composite Application Guidance for WPF &amp; SL, Extension methods, p&amp;p, Patterns &amp; Practices, Prism-v2, Silverlight, Windows Presentation Foundation, WPF">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/site-logo.jpg">
<meta name="twitter:title" content="How to: Add a View to a Region in a particular index with Prism-v2">
<meta name="twitter:description" content="Pseudo-random thoughts related to software development...">
<meta name="twitter:creator" content="@dschenkelman">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="How to: Add a View to a Region in a particular index with Prism-v2">
<meta property="og:description" content="Pseudo-random thoughts related to software development...">
<meta property="og:url" content="http://localhost:4000/2009/03/14/how-to-add-a-view-to-a-region-in-a-particular-index-with-prism-v2/">
<meta property="og:site_name" content="A sea of code">





<link rel="canonical" href="http://localhost:4000/2009/03/14/how-to-add-a-view-to-a-region-in-a-particular-index-with-prism-v2/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="A sea of code Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.min.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/1.7/gist-embed.min.js"></script>

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
	        
			<li>
				
					<a href="http://localhost:4000/">Home</a>
				 
			</li>
	        
			<li>
				
					<a href="http://localhost:4000/about/">About</a>
				 
			</li>
	        
			<li>
				
					<a href="/articles/">Articles</a>
				 
			</li>
	        
	        <li><a href="http://localhost:4000/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
	        <li class="dosearch"><i class="icon-search"></i> Search</li>
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<div class="search-wrapper">
	<div class="search-form">
		<input type="text" class="search-field" placeholder="Search...">
		<i class="icon-remove-sign icon-2x"></i>
		<ul class="search-results post-list"></ul><!-- /.search-results -->
	</div><!-- /.search-form -->
</div><!-- ./search-wrapper -->

<header class="masthead">
	<div class="wrap">
        
    		<a href="http://localhost:4000/" class="site-logo" rel="home" title="A sea of code"><img src="http://localhost:4000/images/site-logo.jpg" width="200" height="200" alt="A sea of code logo" class="animated fadeInUp"></a>
        
        <h1 class="site-title animated fadeIn"><a href="http://localhost:4000/">A sea of code</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Pseudo-random thoughts related to software development...</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://localhost:4000/tags/#C#" title="Pages tagged C#">C#</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#Composite Application Guidance for WPF &amp; SL" title="Pages tagged Composite Application Guidance for WPF &amp; SL">Composite Application Guidance for WPF &amp; SL</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#Extension methods" title="Pages tagged Extension methods">Extension methods</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#p&amp;p" title="Pages tagged p&amp;p">p&amp;p</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#Patterns &amp; Practices" title="Pages tagged Patterns &amp; Practices">Patterns &amp; Practices</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#Prism-v2" title="Pages tagged Prism-v2">Prism-v2</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#Silverlight" title="Pages tagged Silverlight">Silverlight</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#Windows Presentation Foundation" title="Pages tagged Windows Presentation Foundation">Windows Presentation Foundation</a>&nbsp;&bull;&nbsp;<a href="http://localhost:4000/tags/#WPF" title="Pages tagged WPF">WPF</a></span>
        
          <h1 class="entry-title">How to: Add a View to a Region in a particular index with Prism-v2</h1>
        
      </header>
      <footer class="entry-meta">
        <img src="http://localhost:4000/images/bio-photo.jpg" alt="Damian Schenkelman photo" class="author-photo">
        <span class="author vcard">By <span class="fn"><a href="http://localhost:4000/about/" title="About Damian Schenkelman">Damian Schenkelman</a></span></span>
        <span class="entry-date date published"><time datetime="2009-03-14T00:00:00-04:00"><i class="icon-calendar-empty"></i> March 14, 2009</time></span>
        
        
        <span><a href="http://localhost:4000/2009/03/14/how-to-add-a-view-to-a-region-in-a-particular-index-with-prism-v2/" rel="bookmark" title="How to: Add a View to a Region in a particular index with Prism-v2"><i class="icon-link"></i> Permalink</a></span>
        
      </footer>
      <div class="entry-content">
        <p>Yesterday a <a href="http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=50138">question</a> in the <a href="http://compositewpf.codeplex.com/Thread/List.aspx">Prism codeplex forum</a> made me realize that there is no out-of-the-box way to specify the order in which a view will be added to a Region with the Composite Application Library's code shipped with the <a href="http://msdn.microsoft.com/en-us/library/dd458809.aspx">Composite Application Guidance for WPF &amp; Silverlight</a>.</p>
<p>After discussing with <a href="http://blogs.southworks.net/matiasb/">Matias Bonaventura</a> what the best way to get this done was, we decided to use an <a href="http://msdn.microsoft.com/en-us/library/bb383977.aspx">extension method</a> for the <strong>RegionManager</strong> class.</p>
<h5>RegisterViewWithRegionInIndex method</h5>
<ol>
<li>Create a new <strong>public static</strong> class named <strong>RegionManagerCustomExtensions </strong>in any place accessible to where you want to be able to use it.</li>
<li>Add a reference to the Assembly Microsoft.Practices.ServiceLocation(located in the <strong>~DecompressionPath\LIB\Desktop\CommonServiceLocation</strong> folder)</li>
<li>Add the following using statements to theÂ  <strong>RegionManagerCustomExtensions </strong>class:<br />
<blockquote>
<pre><span style="color: blue">using </span>System;
<span style="color: blue">using </span>System.Collections.Generic;
<span style="color: blue">using </span>System.Linq;
<span style="color: blue">using </span>System.Text;
<span style="color: blue">using </span>Microsoft.Practices.Composite.Regions;
<span style="color: blue">using </span>Microsoft.Practices.ServiceLocation;</pre>
<p><a href="http://11011.net/software/vspaste"></a></p></blockquote>
</li>
<li>Add a method named <strong>RegisterViewWithRegionInIndex</strong> with that has the following code:</li>
</ol>
<blockquote>
<pre><span style="color: blue">public static </span><span style="color: #2b91af">IRegionManager </span>RegisterViewWithRegionInIndex(<span style="color: blue">this </span><span style="color: #2b91af">IRegionManager </span>regionManager, <span style="color: blue">string </span>regionName, <span style="color: #2b91af">Type </span>viewType, <span style="color: blue">int </span>index)
       {
           <span style="color: #2b91af">IRegion </span>mainRegion = regionManager.Regions[regionName];
           <span style="color: blue">int </span>viewsAmount = mainRegion.Views.Count();
           <span style="color: blue">if </span>(index &gt; viewsAmount)
           {
               <span style="color: blue">throw new </span><span style="color: #2b91af">IndexOutOfRangeException</span>(<span style="color: #a31515">"Tried to add a view to a region that does not have enough views."</span>);
           }

           <span style="color: blue">if </span>(index &lt; 0)
           {
               <span style="color: blue">throw new </span><span style="color: #2b91af">IndexOutOfRangeException</span>(<span style="color: #a31515">"Tried to add a view in a negative index."</span>);
           }

           <span style="color: blue">object </span>activeView = <span style="color: blue">null</span>;

           <span style="color: blue">if </span>(mainRegion.ActiveViews.Count() == 1)
           {
               activeView = mainRegion.ActiveViews.First();
           }

           <span style="color: blue">var </span>regionViewRegistry = <span style="color: #2b91af">ServiceLocator</span>.Current.GetInstance&lt;<span style="color: #2b91af">IRegionViewRegistry</span>&gt;();

           <span style="color: green">// Save reference to each view existing in the RegionManager after the index to insert.
           </span><span style="color: #2b91af">List</span>&lt;<span style="color: blue">object</span>&gt; views = mainRegion.Views.SkipWhile((view, removeFrom) =&gt; removeFrom &lt; index).ToList();

           <span style="color: green">//Remove elements from region that are after index to insert.
           </span><span style="color: blue">for </span>(<span style="color: blue">int </span>i = 0; i &lt; views.Count; i++)
           {
               mainRegion.Remove(mainRegion.Views.ElementAt(index));
           }

           <span style="color: green">//Register view in index to insert.
           </span>regionViewRegistry.RegisterViewWithRegion(regionName, viewType);

           <span style="color: green">// Adding previously removed views
           </span>views.ForEach(view =&gt; mainRegion.Add(view));

           <span style="color: blue">if </span>(activeView != <span style="color: blue">null</span>)
           {
               mainRegion.Activate(activeView);
           }

           <span style="color: blue">return </span>regionManager;
       }</pre>
<p><a href="http://11011.net/software/vspaste"></a></p>
<p><a href="http://11011.net/software/vspaste"></a></p></blockquote>
<blockquote><p><a href="http://11011.net/software/vspaste"></a></p></blockquote>
<h5>Putting the method to use</h5>
<p>You should be able to use the method now. To test it, I created a couple of extra views in the HelloWorld Quickstart and wrote the following code in the HelloWorldModule class:</p>
<pre>manager.RegisterViewWithRegionInIndex(<span style="color: #a31515">"MainRegion"</span>, <span style="color: blue">typeof</span>(Views.<span style="color: #2b91af">HelloWorldView</span>), 0);
manager.RegisterViewWithRegionInIndex(<span style="color: #a31515">"MainRegion"</span>, <span style="color: blue">typeof</span>(Views.<span style="color: #2b91af">View1</span>), 1);
manager.RegisterViewWithRegionInIndex(<span style="color: #a31515">"MainRegion"</span>, <span style="color: blue">typeof</span>(Views.<span style="color: #2b91af">View2</span>), 1);</pre>
<p>The outcome was the following. As you can see, View2 was placed where View1 was located:</p>
<pre><a href="http://blogs.southworks.net/dschenkelman/files/2009/03/image.png"><span style="font-family: georgia;color: #555555"><img style="float: none;margin-left: auto;margin-right: auto" src="http://blogs.southworks.net/dschenkelman/files/2009/03/image-thumb.png" border="0" alt="image" width="244" height="212" /></span></a></pre>
<p>The method could also be customized to add views to the latest index possible if the index to insert the view into was higher than the amount of views previously existing in the region.</p>
<p>Let me know if you find a good use to this method.</p>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://localhost:4000/2009/03/13/composite-application-guidance-for-wpf-silverlight-prism-v2-reference-implementation-migrated-to-xbap/" class="btn" title="Composite Application Guidance for WPF & Silverlight (Prism v2) Reference Implementation migrated to XBap">Previous article</a>
      
      
        <a href="http://localhost:4000/2009/04/03/fill-the-prism-survey-contribute-with-the-composite-application-guidance/" class="btn" title="Fill the Prism Survey, contribute with the Composite Application Guidance">Next article</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Damian Schenkelman. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="http://twitter.com/dschenkelman" title="Damian Schenkelman on Twitter" target="_blank"><i class="icon-twitter icon-2x"></i></a>
	
	
	<a href="http://linkedin.com/in/damianschenkelman" title="Damian Schenkelman on LinkedIn" target="_blank"><i class="icon-linkedin icon-2x"></i></a>
	
	
	
	<a href="http://github.com/dschenkelman" title="Damian Schenkelman on Github" target="_blank"><i class="icon-github icon-2x"></i></a>
	
</div><!-- /.social-icons -->
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>

<!-- Jekyll Simple Search option -->
<script>
  $(document).ready(function() {
      $('.search-field').simpleJekyllSearch({
          jsonFile : 'http://localhost:4000/search.json',
          searchResults : '.search-results',
          template : '<li><article><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></article></li>',
          noResults: '<p>Nothing found.</p>'
        });
  });

  (function( $, window, undefined ) {
    
     var bs = {
          close: $(".icon-remove-sign"),
          searchform: $(".search-form"),
          canvas: $("body"),
          dothis: $('.dosearch')
      };
    
    bs.dothis.on('click', function() {
      $('.search-wrapper').css({ display: "block" });
      bs.searchform.toggleClass('active');
      bs.searchform.find('input').focus();
      bs.canvas.toggleClass('search-overlay');
    });
    
      bs.close.on('click', function() {
        $('.search-wrapper').removeAttr( 'style' );
        bs.searchform.toggleClass('active');
        bs.canvas.removeClass('search-overlay');
    });
  })( jQuery, window );
</script>


	        

</body>
</html>
