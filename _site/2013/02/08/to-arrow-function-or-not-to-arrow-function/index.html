<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>To Arrow Function or not to Arrow Function &#8211; A sea of code</title>
<meta name="description" content="Pseudo-random thoughts related to software development...">
<meta name="keywords" content="Emerging Technology, JavaScript, TypeScript">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/site-logo.jpg">
<meta name="twitter:title" content="To Arrow Function or not to Arrow Function">
<meta name="twitter:description" content="Pseudo-random thoughts related to software development...">
<meta name="twitter:creator" content="@dschenkelman">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="To Arrow Function or not to Arrow Function">
<meta property="og:description" content="Pseudo-random thoughts related to software development...">
<meta property="og:url" content="/2013/02/08/to-arrow-function-or-not-to-arrow-function/">
<meta property="og:site_name" content="A sea of code">





<link rel="canonical" href="/2013/02/08/to-arrow-function-or-not-to-arrow-function/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="A sea of code Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.min.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">j

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
	        
			<li>
				
					<a href="/">Home</a>
				 
			</li>
	        
			<li>
				
					<a href="/about/">About</a>
				 
			</li>
	        
			<li>
				
					<a href="/articles/">Articles</a>
				 
			</li>
	        
	        <li><a href="/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
	        <li class="dosearch"><i class="icon-search"></i> Search</li>
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<div class="search-wrapper">
	<div class="search-form">
		<input type="text" class="search-field" placeholder="Search...">
		<i class="icon-remove-sign icon-2x"></i>
		<ul class="search-results post-list"></ul><!-- /.search-results -->
	</div><!-- /.search-form -->
</div><!-- ./search-wrapper -->

<header class="masthead">
	<div class="wrap">
        
    		<a href="/" class="site-logo" rel="home" title="A sea of code"><img src="/images/site-logo.jpg" width="200" height="200" alt="A sea of code logo" class="animated fadeInUp"></a>
        
        <h1 class="site-title animated fadeIn"><a href="/">A sea of code</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Pseudo-random thoughts related to software development...</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="/tags/#Emerging Technology" title="Pages tagged Emerging Technology">Emerging Technology</a>&nbsp;&bull;&nbsp;<a href="/tags/#JavaScript" title="Pages tagged JavaScript">JavaScript</a>&nbsp;&bull;&nbsp;<a href="/tags/#TypeScript" title="Pages tagged TypeScript">TypeScript</a></span>
        
          <h1 class="entry-title">To Arrow Function or not to Arrow Function</h1>
        
      </header>
      <footer class="entry-meta">
        <img src="/images/bio-photo.jpg" alt="Damian Schenkelman photo" class="author-photo">
        <span class="author vcard">By <span class="fn"><a href="/about/" title="About Damian Schenkelman">Damian Schenkelman</a></span></span>
        <span class="entry-date date published"><time datetime="2013-02-08T00:00:00-05:00"><i class="icon-calendar-empty"></i> February 08, 2013</time></span>
        
        <span class="entry-comments"><i class="icon-comment-alt"></i> <a href="#disqus_thread">Comment</a></span>
        <span><a href="/2013/02/08/to-arrow-function-or-not-to-arrow-function/" rel="bookmark" title="To Arrow Function or not to Arrow Function"><i class="icon-link"></i> Permalink</a></span>
        
      </footer>
      <div class="entry-content">
        <p>If you have used TypeScript you are probably aware of the compiled outcome of an Arrow Function (section 4.9.2 of the <a href="http://www.typescriptlang.org/Content/TypeScript%20Language%20Specification.pdf">TypeScript Language Specification</a>). The idea behind using <strong>() =&gt; {…};</strong> instead of <strong>function(){…};</strong> is to have access to the object represented by <em>this</em> in the outer scope, which is what you would expect when using a C# lambda. Of course this feature is particulalry useful in JavaScript because <a href="http://es5.github.com/#x10.4.3"><em>this</em> holds a reference to the object to which a function was applied or called</a>, and more often than not the <em>this </em>inside the function's <a href="http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/">execution context</a> ends up being different from the one in the outer execution context.</p>
<p>When using an Arrow Function, TypeScript automatically assigns <em>this </em>to a separate variable in the outer execution context (called <em>_this),</em> which can be accessed by the function that results of the compilation of the Arrow Function through its closure. As the previous sentence was probably not the simplest one to digest, take the following TypeScript code snippet as an example:</p>
<code data-gist-id="18841f8d7d2b08ab0e92" data-gist-file="MyClass.ts"></code>
<p>The resulting JavaScript is:</p>
<code data-gist-id="18841f8d7d2b08ab0e92" data-gist-file="MyClass.js"></code>
<p>As you can see, partialAdd stores <em>this </em>in the local <em>_this</em> variable which is accessible from the function that is returned through its closure. On the other hand, partialAdd2 uses <em>this </em>as the variable, but as I mentioned before <em>this</em> might not be "an instance of MyClass" but something completely different instead.</p>
<h2>Complex Cases</h2>
<p>You could (wrongly) deduce that every time you need access to the outer <em>this</em> inside the function you should use an Arrow Function, but what if you need to use both the outer <em>this </em>and the object on which the function was applied? That could be a usual situation in an event handler, <a href="http://api.jquery.com/click/">which applies the callback functions to the target DOM elements when handling the event</a> (for the sake of the example assume that there is no way to other way to access the DOM element other than <em>this</em>).</p>
<p>In these cases, it is important to understand what the compiler is doing underneath the hood. The two common approaches that would lead to errors are:</p>
<ol>
<li><strong>Using an Arrow Function:</strong> this would cause TypeScript's <em>this </em>to shadow the compiled JavaScript's <em>this</em>, not allowing you to access the DOM elements that was clicked inside the click handler.</li>
<li><strong>Using a function literal: </strong>this would cause the outer <em>this</em> to not be accessible, which is unexpected for developers used to C#.</li>
</ol>
<h2>The Answer</h2>
<p>One possible (and simple) solution to this is the usual workaround (<em>that = this</em>):</p>
<code data-gist-id="18841f8d7d2b08ab0e92" data-gist-file="MyClass2.ts"></code>
<p>The following figures show that TypeScript's type inference system confirms the comments from the previous code snippet:</p>
<p><em>this can be an instance of any type, as it depends on the object on which the function was called</em></p>
<p><a href="http://blogs.southworks.net/dschenkelman/files/2013/02/image2.png"><img style="padding-left: 0px;padding-right: 0px;padding-top: 0px;border: 0px" src="http://blogs.southworks.net/dschenkelman/files/2013/02/image_thumb2.png" border="0" alt="image" width="494" height="247" /></a></p>
<p><em>that is an instance of MyClass</em></p>
<p><a href="http://blogs.southworks.net/dschenkelman/files/2013/02/image3.png"><img style="padding-left: 0px;padding-right: 0px;padding-top: 0px;border: 0px" src="http://blogs.southworks.net/dschenkelman/files/2013/02/image_thumb3.png" border="0" alt="image" width="502" height="247" /></a></p>
<h2>Conclusion</h2>
<p>This is not a complex issue, but is one that I've seen a couple of times while working with TypeScript, so hopefully if you ever run into it you will be able to solve it in no time.</p>

        <div id="disqus_thread"></div><!-- /#disqus_thread -->
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/2012/08/18/creating-indexes-via-data-annotations-with-entity-framework-5-0/" class="btn" title="Creating Indexes via Data Annotations with Entity Framework 5.0">Previous article</a>
      
      
        <a href="/2013/05/25/taking-ndepend-4-code-query-over-linq-for-a-spin-with-needle-container/" class="btn" title="Taking NDepend 4 Code Query over LINQ for a spin with Needle Container">Next article</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Damian Schenkelman. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="http://twitter.com/dschenkelman" title="Damian Schenkelman on Twitter" target="_blank"><i class="icon-twitter icon-2x"></i></a>
	
	
	<a href="http://linkedin.com/in/damianschenkelman" title="Damian Schenkelman on LinkedIn" target="_blank"><i class="icon-linkedin icon-2x"></i></a>
	
	
	
	<a href="http://github.com/dschenkelman" title="Damian Schenkelman on Github" target="_blank"><i class="icon-github icon-2x"></i></a>
	
</div><!-- /.social-icons -->
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/1.7/gist-embed.min.js"></script>


<!-- Jekyll Simple Search option -->
<script>
  $(document).ready(function() {
      $('.search-field').simpleJekyllSearch({
          jsonFile : '/search.json',
          searchResults : '.search-results',
          template : '<li><article><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></article></li>',
          noResults: '<p>Nothing found.</p>'
        });
  });

  (function( $, window, undefined ) {

     var bs = {
          close: $(".icon-remove-sign"),
          searchform: $(".search-form"),
          canvas: $("body"),
          dothis: $('.dosearch')
      };

    bs.dothis.on('click', function() {
      $('.search-wrapper').css({ display: "block" });
      bs.searchform.toggleClass('active');
      bs.searchform.find('input').focus();
      bs.canvas.toggleClass('search-overlay');
    });

      bs.close.on('click', function() {
        $('.search-wrapper').removeAttr( 'style' );
        bs.searchform.toggleClass('active');
        bs.canvas.removeClass('search-overlay');
    });
  })( jQuery, window );
</script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-50875301-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'dschenkelman'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	        

</body>
</html>
