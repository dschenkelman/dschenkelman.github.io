<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>fakewin8: Easy fakes for Windows Store apps unit tests &#8211; A sea of code</title>
<meta name="description" content="Pseudo-random thoughts related to software development...">
<meta name="keywords" content="C#, Emerging Technology, TDD, Unit Tests">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/site-logo.jpg">
<meta name="twitter:title" content="fakewin8: Easy fakes for Windows Store apps unit tests">
<meta name="twitter:description" content="Pseudo-random thoughts related to software development...">
<meta name="twitter:creator" content="@dschenkelman">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="fakewin8: Easy fakes for Windows Store apps unit tests">
<meta property="og:description" content="Pseudo-random thoughts related to software development...">
<meta property="og:url" content="/2013/08/04/fakewin8-easy-fakes-for-windows-store-apps-unit-tests/">
<meta property="og:site_name" content="A sea of code">





<link rel="canonical" href="/2013/08/04/fakewin8-easy-fakes-for-windows-store-apps-unit-tests/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="A sea of code Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.min.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">j

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
	        
			<li>
				
					<a href="/">Home</a>
				 
			</li>
	        
			<li>
				
					<a href="/about/">About</a>
				 
			</li>
	        
			<li>
				
					<a href="/articles/">Articles</a>
				 
			</li>
	        
	        <li><a href="/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
	        <li class="dosearch"><i class="icon-search"></i> Search</li>
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<div class="search-wrapper">
	<div class="search-form">
		<input type="text" class="search-field" placeholder="Search...">
		<i class="icon-remove-sign icon-2x"></i>
		<ul class="search-results post-list"></ul><!-- /.search-results -->
	</div><!-- /.search-form -->
</div><!-- ./search-wrapper -->

<header class="masthead">
	<div class="wrap">
        
    		<a href="/" class="site-logo" rel="home" title="A sea of code"><img src="/images/site-logo.jpg" width="200" height="200" alt="A sea of code logo" class="animated fadeInUp"></a>
        
        <h1 class="site-title animated fadeIn"><a href="/">A sea of code</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Pseudo-random thoughts related to software development...</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="/tags/#C#" title="Pages tagged C#">C#</a>&nbsp;&bull;&nbsp;<a href="/tags/#Emerging Technology" title="Pages tagged Emerging Technology">Emerging Technology</a>&nbsp;&bull;&nbsp;<a href="/tags/#TDD" title="Pages tagged TDD">TDD</a>&nbsp;&bull;&nbsp;<a href="/tags/#Unit Tests" title="Pages tagged Unit Tests">Unit Tests</a></span>
        
          <h1 class="entry-title">fakewin8: Easy fakes for Windows Store apps unit tests</h1>
        
      </header>
      <footer class="entry-meta">
        <img src="/images/bio-photo.jpg" alt="Damian Schenkelman photo" class="author-photo">
        <span class="author vcard">By <span class="fn"><a href="/about/" title="About Damian Schenkelman">Damian Schenkelman</a></span></span>
        <span class="entry-date date published"><time datetime="2013-08-04T00:00:00-04:00"><i class="icon-calendar-empty"></i> August 04, 2013</time></span>
        
        <span class="entry-comments"><i class="icon-comment-alt"></i> <a href="#disqus_thread">Comment</a></span>
        <span><a href="/2013/08/04/fakewin8-easy-fakes-for-windows-store-apps-unit-tests/" rel="bookmark" title="fakewin8: Easy fakes for Windows Store apps unit tests"><i class="icon-link"></i> Permalink</a></span>
        
      </footer>
      <div class="entry-content">
        <p><span style="font-size: xx-small">In case you are short in time, here's the Github link: </span><a href="https://github.com/dschenkelman/fakewin8"><span style="font-size: xx-small">https://github.com/dschenkelman/fakewin8</span></a><span style="font-size: xx-small">. Otherwise, read on.</span></p>
<p>If you are reading this, you probably know that due to the changes in the reflection API, all unit testing libraries that depend on the creation of dynamic proxies do not work in Windows RT (for example <a href="https://groups.google.com/forum/#!topic/moqdisc/nP5kS_ZNZP0">Moq</a>). As someone who does a lot of Windows 8 development and makes heavy use of unit tests, this was something that really changed the way I approach unit testing.</p>
<p>I’ve seen many different proposals to workaround this issue, such as <a href="http://outcoldman.com/en/blog/show/332" target="_blank">having linked files</a>, having the components under test in a portable class library (and then using any mocking framework) and using <a href="http://prismwindowsruntime.codeplex.com/SourceControl/latest#Prism.StoreApps.Tests/Mocks/MockPageViewModel.cs" target="_blank">public properties that expose setters for the methods to fake</a>. While those approaches do work fine (in fact I’ve tried all of them), none of them fully suit my needs. I just did not feel completely comfortable with only one of them.  That’s why I came up with the following.</p>
<h2>Premises</h2>
<ol>
<li>For each interface or base class, I want to create <strong>only one class that can be used as a stub/mock in any test method</strong>. This means that all methods must be easy to setup with different logic for different unit tests.</li>
<li>No additional components should be required (i.e.: no portable class libraries, no linked files).</li>
<li>Method invocations should be automatically tracked so assertions can be performed based on them.</li>
<li>Fake class generation should be automatic. We want to focus on the tests development, not the fakes development.</li>
</ol>
<h2>Proposal</h2>
<p><a href="https://github.com/dschenkelman/fakewin8">fakewin8</a> proposes the usage of classes like <a href="https://github.com/dschenkelman/fakewin8/blob/master/src/FakeWin8/FakeAction.cs">FakeAction </a>and <a href="https://github.com/dschenkelman/fakewin8/blob/master/src/FakeWin8/FakeFunc.cs">FakeFunc</a>, which act as normal <a href="http://msdn.microsoft.com/en-us/library/system.action.aspx" target="_blank">Action</a> and <a href="http://msdn.microsoft.com/en-us/library/bb534960.aspx" target="_blank">Func</a>, but keep track of the number invocations and parameters on each of them.</p>
<p>For example, for this interface:</p>
<code data-gist-id="b476d386055a42b3b637" data-gist-file="INavigationService.cs"></code>
<p>The following fake class should be created (and only this class should be required):</p>
<code data-gist-id="b476d386055a42b3b637" data-gist-file="FakeNavigationService.cs"></code>
<p>The <strong>FakeAction</strong> and <strong>FakeFunc </strong>classes (at the moment they support until up to 3 parameters) can be leveraged like this in your unit tests:</p>
<code data-gist-id="b476d386055a42b3b637" data-gist-file="UnitTests.cs"></code>
<p>Additionally, given the path to an assembly and an output directory, you can automatically generate the fake classes.</p>
<pre class="brush: bash;">FakeWin8.Generator.Console.exe &lt;dllPath&gt; &lt;outputDir&gt;</pre>
<p>The generated code for the sample interface is the following one (no indentation yet):</p>
<code data-gist-id="b476d386055a42b3b637" data-gist-file="GeneratedFakeNavigationService.cs"></code>

        <div id="disqus_thread"></div><!-- /#disqus_thread -->
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/2013/08/02/asynchronous-io-in-c-introduction/" class="btn" title="Asynchronous I/O in C#: Introduction">Previous article</a>
      
      
        <a href="/2013/08/06/fakewin8-configuring-valid-parameters-for-fake-methods/" class="btn" title="fakewin8: Configuring valid parameters for fake methods">Next article</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Damian Schenkelman. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="http://twitter.com/dschenkelman" title="Damian Schenkelman on Twitter" target="_blank"><i class="icon-twitter icon-2x"></i></a>
	
	
	<a href="http://linkedin.com/in/damianschenkelman" title="Damian Schenkelman on LinkedIn" target="_blank"><i class="icon-linkedin icon-2x"></i></a>
	
	
	
	<a href="http://github.com/dschenkelman" title="Damian Schenkelman on Github" target="_blank"><i class="icon-github icon-2x"></i></a>
	
</div><!-- /.social-icons -->
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/1.7/gist-embed.min.js"></script>


<!-- Jekyll Simple Search option -->
<script>
  $(document).ready(function() {
      $('.search-field').simpleJekyllSearch({
          jsonFile : '/search.json',
          searchResults : '.search-results',
          template : '<li><article><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></article></li>',
          noResults: '<p>Nothing found.</p>'
        });
  });

  (function( $, window, undefined ) {

     var bs = {
          close: $(".icon-remove-sign"),
          searchform: $(".search-form"),
          canvas: $("body"),
          dothis: $('.dosearch')
      };

    bs.dothis.on('click', function() {
      $('.search-wrapper').css({ display: "block" });
      bs.searchform.toggleClass('active');
      bs.searchform.find('input').focus();
      bs.canvas.toggleClass('search-overlay');
    });

      bs.close.on('click', function() {
        $('.search-wrapper').removeAttr( 'style' );
        bs.searchform.toggleClass('active');
        bs.canvas.removeClass('search-overlay');
    });
  })( jQuery, window );
</script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-50875301-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'dschenkelman'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	        

</body>
</html>
